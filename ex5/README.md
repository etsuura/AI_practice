# 人工知能入門2019 演習5, 6
講義日 2019/10/26  

## 演習課題5-1
### 課題

- 文字bi-gramによる単語生成

- 文字のつながりの利得がリンク上に示してある.

- **得点が最も高くなる経路を見つけよ.**

![graph](https://github.com/etsuura/AI_practice/blob/master/ex5/graph.jpg)

### 解答

ソースコードを[ex5_1 and ex5_2.py](https://github.com/etsuura/AI_practice/blob/master/ex5/ex5_1%20and%20ex5_2.py)に示す.

クラス```Graph```において各ノードのリンクやコスト, それに対応する文字,各時刻における選択肢を辞書型を用いて表す.

関数```DynamicProgramming```において動的計画法によって多段階決定問題の経路の最大値を求める.

この際, クラス```Graph```の```cost_memory```に各ノードの経路のコストの最大値, ```route```に直前に通ったノードを辞書型で記録する.

実行結果より以下の文字列が得られる.
>りつうあさん
>
>最大コストは23です.

---

## 演習課題5-2
### 課題

- 課題1において最終的にメモリに格納された各ノードの最大コストFtと経路st*がどうなっているのか示せ.

### 解答

ソースコードを[ex5_1 and ex5_2.py](https://github.com/etsuura/AI_practice/blob/master/ex5/ex5_1%20and%20ex5_2.py)に示す.

出力されたクラス```Graph```のFtを表す```cost_memory```およびst*を表す```route```は下記のとおりである.
>Ft
>{'START': 0, 'A': 2, 'B': 5, 'C': 4, 'D': 8, 'E': 9, 'F': 8, 'G': 11, 'H': 8, 'I': 11, 'J': 15, 'K': 11, 'L': 15, 'GOAL': 23}
>
>st*
{'A': 'START', 'B': 'START', 'C': 'START', 'D': 'B', 'E': 'C', 'F': 'B', 'G': 'E', 'H': 'F', 'I': 'E', 'J': 'G', 'K': 'I', 'L': 'H', 'GOAL': 'L'}

st*の結果より最適な経路は

```GOAL → L → H → F → B → START```

であることがわかる.

---

## 演習課題5-3
### 課題
- 「りつめいかん」と「はつめいか」の編集距離を動的計画法を用いて求めよ.

### 解答

ソースコードを[ex5_3.py](https://github.com/etsuura/AI_practice/blob/master/ex5/ex5_3.py)に示す.

関数```levenshtein```において動的計画法によって2つの文字列の編集距離を求める.

実行結果は以下のとおりである.

>1  2  3  4  5  
>2  2  3  4  5  
>3  3  2  3  4  
>4  4  3  2  3  
>5  5  4  3  2  
>6  6  5  4  3  
>Levenshtein Distance is 3

これを表にまとめると下記の表になる.

![graph](https://github.com/etsuura/AI_practice/blob/master/ex5/table.jpg)

また, 出力結果および表から「はつめいか」と「りつめいかん」の編集距離は3であることがわかる.

---

## 演習課題6-1
### 課題
![graph](https://github.com/etsuura/AI_practice/blob/master/ex5/q6_1.jpg)
1. P(X1)
2. P(Y2|X2)
3. P(X1,Y2)
4. P(Y1)

### 解答

1. P(X1)
    - 2/3の確率で皮の袋:X1が選ばれるので  
     P(X1) = 2/3

2. P(Y2|X2)
    - X2であるときY2である条件付き確率は, 布の袋:X2において20個の玉のうち青い玉:Y2は1個であるので  
    P(Y2|X2) = 1/20
    
3. P(X1,Y2)
    - P(X1,Y2)は同時確率であるので  
    P(X1,Y2) = P(Y2,X1) = P(Y2|X1)*P(X1) =  5/20 * 2/3 = 1/6
    
4. P(Y1)
    - P(Y1)はどちらの袋においても20個中15個が赤い玉:Y1であるため   
    P(Y1) = 15/20 = 3/4
    
---

## 演習課題6-2
### 課題
![graph](https://github.com/etsuura/AI_practice/blob/master/ex5/q6_1.jpg)
1. P(X1|Y2)
2. P(X2|Y3)
3. 赤い玉が取り出されたとき, 取り出した袋はどちらだった可能性が高いか？

### 解答
1. P(X1|Y2)
    - Y2であったときX1である条件付き確率は, ベイズの定理より   
    P(X1|Y2) = P(Y2|X1)*P(X1) / P(Y2)  
    
    - ここで, P(Y2)は  
    P(Y2) = (2/3) * (5/20) + (1/3) * (1/20) = 11/60  
      
    - よって, 求める解は  
     P(X1|Y2) = (1/6) / (11/60) = 10/11
    
2. P(X2|Y3)
    -Y3であったときX2である条件付き確率は, 黄色い玉:Y3は布の袋:X2にしか入っていないため  
    P(X2|Y3) = 1
    
3. 赤い玉が取り出されたとき, 取り出した袋はどちらだった可能性が高いか？
    - 赤い玉:Y1が取り出された際, それぞれの袋である条件付き確率P(X1|Y1)とP(X2|Y1)はそれぞれ  
    P(X1|Y1) = 2/3  
    P(X2|Y1) = 1/3  
    
    - よって
    P(X1|Y1) > P(X2|Y1)より, X1:皮の袋である可能性が高い.
    
---

## 演習課題6-3
### 課題
![graph](https://github.com/etsuura/AI_practice/blob/master/ex5/q6_3.jpg)

### 解答
move, stop, move という３つの行動を行った際に状態１から状態３に移動する確率の組み合わせは  
- (p(1,3), p(3,1)), (p(3,1), p(3,3))  

の２組である. よって,求める確率Pは  
- P = (0.1 * 0.4) + (0.4 * 0.5)  = 0.24
